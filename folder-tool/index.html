<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ•ã‚©ãƒ«ãƒ€è‡ªå‹•ç”Ÿæˆãƒ„ãƒ¼ãƒ«</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
                   "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      max-width: 600px;
      width: 100%;
      padding: 40px;
    }
    h1 {
      font-size: 28px;
      color: #333;
      margin-bottom: 10px;
      text-align: center;
    }
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }
    .mode-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
    }
    .mode-btn {
      flex: 1;
      padding: 12px;
      border: 2px solid #ddd;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    .mode-btn:hover {
      border-color: #667eea;
      background: #f8f9ff;
    }
    .mode-btn.active {
      border-color: #667eea;
      background: #667eea;
      color: white;
    }
    .input-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
      font-size: 14px;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s;
    }
    input[type="text"]:focus {
      outline: none;
      border-color: #667eea;
    }
    .example {
      font-size: 12px;
      color: #999;
      margin-top: 4px;
    }
    .generate-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      margin-top: 10px;
    }
    .generate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }
    .generate-btn:active {
      transform: translateY(0);
    }
    .generate-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    .result {
      margin-top: 20px;
      padding: 16px;
      background: #f0f4ff;
      border-radius: 8px;
      border-left: 4px solid #667eea;
      display: none;
    }
    .result.show {
      display: block;
    }
    .result h3 {
      font-size: 16px;
      color: #667eea;
      margin-bottom: 8px;
    }
    .result p {
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }
    .error {
      background: #fff0f0;
      border-left-color: #f44336;
    }
    .error h3 {
      color: #f44336;
    }
    #mode2 {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“ ãƒ•ã‚©ãƒ«ãƒ€è‡ªå‹•ç”Ÿæˆãƒ„ãƒ¼ãƒ«</h1>
    <p class="subtitle">æ—¥ä»˜ãƒ•ã‚©ãƒ«ãƒ€ã¨ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</p>

    <div class="mode-selector">
      <button class="mode-btn active" onclick="switchMode(1)">æœŸé–“æŒ‡å®šãƒ¢ãƒ¼ãƒ‰</button>
      <button class="mode-btn" onclick="switchMode(2)">æœˆæŒ‡å®šãƒ¢ãƒ¼ãƒ‰</button>
    </div>

    <div id="mode1">
      <div class="input-group">
        <label>ãƒ•ã‚©ãƒ«ãƒ€åï¼ˆæœŸé–“æŒ‡å®šï¼‰</label>
        <input type="text" id="periodInput" placeholder="2025.9-2026.5">
        <div class="example">ä¾‹: 2025.9-2026.5 ã¾ãŸã¯ 2025.11-2026.3</div>
      </div>
      <button class="generate-btn" onclick="generatePeriodFolders()">ğŸ“¦ ãƒ•ã‚©ãƒ«ãƒ€ç”Ÿæˆ & ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    </div>

    <div id="mode2">
      <div class="input-group">
        <label>ãƒ•ã‚©ãƒ«ãƒ€åï¼ˆæœˆæŒ‡å®šï¼‰</label>
        <input type="text" id="monthInput" placeholder="R7.12">
        <div class="example">ä¾‹: R7.12 ã¾ãŸã¯ R6.3</div>
      </div>
      <button class="generate-btn" onclick="generateMonthFolders()">ğŸ“¦ ãƒ•ã‚©ãƒ«ãƒ€ç”Ÿæˆ & ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    </div>

    <div id="result" class="result"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    function switchMode(mode) {
      const btns = document.querySelectorAll('.mode-btn');
      btns.forEach((btn, i) => {
        btn.classList.toggle('active', i + 1 === mode);
      });
      document.getElementById('mode1').style.display = mode === 1 ? 'block' : 'none';
      document.getElementById('mode2').style.display = mode === 2 ? 'block' : 'none';
      hideResult();
    }

    function showResult(message, isError = false) {
      const resultDiv = document.getElementById('result');
      resultDiv.className = 'result show' + (isError ? ' error' : '');
      resultDiv.innerHTML = `
        <h3>${isError ? 'âš ï¸ ã‚¨ãƒ©ãƒ¼' : 'âœ… å®Œäº†'}</h3>
        <p>${message}</p>
      `;
    }

    function hideResult() {
      document.getElementById('result').classList.remove('show');
    }

    function getDaysInMonth(year, month) {
      return new Date(year, month, 0).getDate();
    }

    async function generatePeriodFolders() {
      hideResult();
      const input = document.getElementById('periodInput').value.trim();
      
      if (!input) {
        showResult('ãƒ•ã‚©ãƒ«ãƒ€åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', true);
        return;
      }

      const parts = input.split('-');
      if (parts.length !== 2) {
        showResult('ãƒ•ã‚©ãƒ«ãƒ€åã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚<br>ä¾‹: 2025.9-2026.5', true);
        return;
      }

      const [startStr, endStr] = parts;
      const startParts = startStr.split('.');
      const endParts = endStr.split('.');

      if (startParts.length !== 2 || endParts.length !== 2) {
        showResult('ãƒ•ã‚©ãƒ«ãƒ€åã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚<br>ä¾‹: 2025.9-2026.5', true);
        return;
      }

      const startYear = parseInt(startParts[0]);
      const startMonth = parseInt(startParts[1]);
      const endYear = parseInt(endParts[0]);
      const endMonth = parseInt(endParts[1]);

      const zip = new JSZip();
      const rootFolder = zip.folder(input);
      let folderCount = 0;

      let curYear = startYear;
      let curMonth = startMonth;

      while (true) {
        if (curYear > endYear || (curYear === endYear && curMonth > endMonth)) break;

        const daysInMonth = getDaysInMonth(curYear, curMonth);
        const monthStr = curMonth < 10 && startParts[1].startsWith('0') ? `0${curMonth}` : `${curMonth}`;

        for (let day = 1; day <= daysInMonth; day++) {
          const dateFolder = `${curYear}.${monthStr}.${day}`;
          rootFolder.folder(dateFolder).folder('æ¸ˆ');
          folderCount++;
        }

        curMonth++;
        if (curMonth > 12) {
          curMonth = 1;
          curYear++;
        }
      }

      const blob = await zip.generateAsync({ type: 'blob' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${input}.zip`;
      a.click();
      URL.revokeObjectURL(url);

      showResult(`${folderCount}å€‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã—ãŸã€‚<br>ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...`);
    }

    async function generateMonthFolders() {
      hideResult();
      const input = document.getElementById('monthInput').value.trim();
      
      if (!input) {
        showResult('ãƒ•ã‚©ãƒ«ãƒ€åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', true);
        return;
      }

      const parts = input.split('.');
      if (parts.length < 2) {
        showResult('ãƒ•ã‚©ãƒ«ãƒ€åã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚<br>ä¾‹: R7.12', true);
        return;
      }

      const month = parts[1];
      const zip = new JSZip();
      const rootFolder = zip.folder(input);

      for (let day = 1; day <= 31; day++) {
        const dayFolder = `${month}.${day}`;
        rootFolder.folder(dayFolder);
      }

      const blob = await zip.generateAsync({ type: 'blob' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${input}.zip`;
      a.click();
      URL.revokeObjectURL(url);

      showResult(`31å€‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã—ãŸã€‚<br>ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...`);
    }
  </script>
</body>
</html>
